================================================================================
QUICK REFERENCE: GUI-BASED FACE SELECTION
================================================================================

WHAT CHANGED?
  OLD: OpenCV windows crashed on systems without display support
  NEW: CustomTkinter GUI dialog works everywhere

ONE LINE SUMMARY:
  Click "Select Face" button to manually select guard face area in GUI dialog

================================================================================
5-MINUTE QUICK START
================================================================================

1. RUN APP
   python Niraskhan_Done_1.py

2. CLICK "Load Targets"
   - System auto-detects faces
   - Guards show: OK (done) or MANUAL (needs selection)

3. FOR EACH GUARD WITH "MANUAL" STATUS
   - Click "Select Face" button
   - Draw rectangle around face in dialog
   - Click "Confirm Selection"

4. CLICK "Select Guards & Start Tracking"
   - All guards with OK status are ready

DONE! Total time: 2-5 minutes depending on number of guards

================================================================================
STATUS INDICATORS
================================================================================

OK (Green)
  ✓ Auto-detection found face
  ✓ Embedding extracted
  ✓ Ready to use - no action needed

MANUAL (Orange)
  ! Auto-detection didn't find face
  ! Click "Select Face" button to manually select
  ! Then changes to OK

ERROR (Red)
  ✗ Profile image missing or corrupted
  ✗ Contact system admin

================================================================================
BUTTON ACTIONS
================================================================================

"Load Targets"
  Click once to:
  - Scan guard_profiles/ directory
  - Auto-detect faces in all images
  - Show results in preview panel
  - Takes 5-10 seconds for 10 guards

"Select Face" (Orange button)
  Click to:
  - Open CustomTkinter dialog
  - Display guard's profile photo
  - Let user draw rectangle around face
  - Extract FaceNet embedding
  - Update status to OK

"Confirm Selection" (In dialog)
  Click to:
  - Confirm rectangle selection
  - Extract embedding
  - Close dialog
  - Show success message

"Cancel" (In dialog)
  Click to:
  - Abort face selection
  - Close dialog without saving
  - Keep status as MANUAL

================================================================================
DRAWING RECTANGLE (IN DIALOG)
================================================================================

GOAL: Select face area

STEPS:
1. Click inside image area
2. Hold mouse button down
3. Drag to opposite corner
4. Release mouse button

RECTANGLE SHOULD:
✓ Include forehead to chin
✓ Include both ears
✓ Be tight around face
✗ NOT cut off any face parts
✗ NOT include large background

If wrong:
- Draw again (overwrites previous)
- No limit on retries
- Last one is used

================================================================================
DIALOG TIPS
================================================================================

CANVAS TOO SMALL?
- Maximize dialog window
- Image scales to fit

HARD TO SEE RECTANGLE?
- Green color used for visibility
- Try on well-lit area of face
- Redo if needed

PHOTO QUALITY ISSUES?
- Works best with clear face photos
- Recent photos better than old ones
- Frontal angles best
- If too poor, skip and try later

MULTIPLE PEOPLE IN PHOTO?
- Select the guard's face only
- Ignore other people

================================================================================
LOG MESSAGES (KEY ONES)
================================================================================

SUCCESS:
  [EMBED] Auto-loaded embedding for guard: Rudresh
    → Face found automatically, status = OK

  [CROP-INTERACTIVE] Successfully extracted embedding for Rudresh
    → Manual selection worked, status = OK

NEEDS ACTION:
  [EMBED] No faces detected in profile image for Krunal
    → Click "Select Face" button for Krunal

FAILURES:
  [CROP-INTERACTIVE] User cancelled face selection for Rudresh
    → User clicked Cancel, try again if needed

  [CROP-INTERACTIVE] Failed to extract embedding for Rudresh
    → Something went wrong, try again

================================================================================
TROUBLESHOOTING
================================================================================

PROBLEM: Dialog doesn't appear
  FIX: Make sure main app window is visible and focused
  FIX: Wait a few seconds for dialog to render

PROBLEM: Can't draw rectangle
  FIX: Click inside the image area first
  FIX: Hold down mouse button while dragging
  FIX: Make sure to release mouse button

PROBLEM: Status still shows MANUAL after clicking button
  FIX: Embedding extraction failed
  FIX: Check logs for error message
  FIX: Try again: click "Select Face" button again
  FIX: Try selecting different face area

PROBLEM: Dialog says "No Selection" error
  FIX: You didn't draw a rectangle
  FIX: Click and drag to draw rectangle first
  FIX: Then click "Confirm Selection"

PROBLEM: Success message but status still MANUAL
  FIX: Refresh screen: click another guard then back
  FIX: Close and reopen app
  FIX: Check logs for details

================================================================================
KEYBOARD SHORTCUTS (NONE - USE MOUSE)
================================================================================

Everything is button-based in new version
- No SPACE to confirm
- No ESC to cancel
- Use mouse + buttons only

Previous version used keyboard - that's OLD
New version uses GUI buttons - that's NEW

================================================================================
PERFORMANCE
================================================================================

LOAD TARGETS: 5-10 seconds for 10 guards
  - Scans directory
  - Loads images
  - Auto-detects faces
  - Not blocking

MANUAL SELECTION (per guard): 10-30 seconds
  - Dialog appears instantly
  - User draws rectangle (10-15 seconds)
  - Embedding extraction (2-5 seconds)
  - Dialog closes with message (1 second)

TOTAL SETUP TIME: 2-10 minutes for 10 guards
  - Depends on how many need manual selection
  - Pure auto = 10 seconds
  - All manual = 5+ minutes
  - Mixed = 2-3 minutes average

================================================================================
FILE LOCATIONS
================================================================================

GUARD PROFILES:
  guard_profiles/target_[Name]_face.jpg
  (or target_[Name]/front.jpg for multi-angle)

LOGS:
  logs/session.log
  (check here for detailed error messages)

EMBEDDINGS (IN MEMORY):
  Stored in app.guard_embeddings dictionary
  Only during current session
  Lost on restart (re-extracted on load)

================================================================================
ADVANCED TRICKS
================================================================================

RE-SELECT FACE AREA:
  1. Click "Select Face" button again
  2. Draw new rectangle
  3. Click "Confirm Selection"
  4. Old embedding replaced with new one

SKIP A GUARD:
  1. Click Cancel in dialog (don't select face)
  2. Guard remains with MANUAL status
  3. Can select later if needed
  4. Or proceed to tracking without guard

RETRY FAILED SELECTION:
  1. Click "Select Face" button
  2. Try again with different rectangle area
  3. Better photo crop might help

RELOAD ALL:
  1. Click "Load Targets" again
  2. Auto-detection runs fresh
  3. Clear old embeddings and try again

================================================================================
COMPARISON: OLD vs NEW
================================================================================

OLD (OpenCV Windows - BROKEN):
  - Auto-prompted during load (blocking)
  - Used cv2.namedWindow
  - Crashed on systems without display
  - Keyboard controls (SPACE/ESC)
  ✗ Does not work

NEW (CustomTkinter GUI - WORKING):
  - Button-triggered on demand
  - Uses CTkToplevel dialog
  - Works on all systems
  - Mouse + button controls
  ✓ Works everywhere

ADVANTAGE OF NEW:
  + Works on headless systems
  + Works on Windows/Mac/Linux
  + Familiar GUI interface
  + Non-blocking (don't interrupt workflow)
  + Can use anytime during session

================================================================================
WHEN TO USE MANUAL SELECTION
================================================================================

AUTO-DETECTION WORKS WHEN:
✓ Face is frontal/forward-facing
✓ Good lighting (not dark/shadowed)
✓ Face size ~50+ pixels
✓ Clear, unobstructed face
✓ Recent, sharp photo

USE MANUAL SELECTION WHEN:
! Face is at angle (profile, looking down)
! Poor lighting (dark, overexposed)
! Face size too small (<50 px)
! Face partially obstructed
! Blurry or old photo
! Auto-detection failed (marked MANUAL)

================================================================================
BEST PRACTICES
================================================================================

1. DO LOAD ALL GUARDS FIRST
   Click "Load Targets" once
   Let auto-detection run to completion

2. DO SELECT FACES IN ANY ORDER
   Process guards in any sequence
   No required order

3. DO TAKE YOUR TIME
   Careful rectangle selection > speed
   Quality matters more than speed

4. DO RETRY IF NEEDED
   Embedding not good? Try again
   Different rectangle area might help

5. DON'T FORCE IT
   Can't get good selection? Skip it
   Add later, or proceed without guard

6. DON'T CLOSE DIALOG BEFORE CONFIRMING
   Click button to close properly
   Not X button (might lose state)

7. DON'T EDIT PROFILE IMAGES
   Use original photo as-is
   Selection tool crops, not saves

================================================================================
SUMMARY
================================================================================

NEW SYSTEM:
- CustomTkinter GUI (works everywhere)
- Auto-detection on load (faster)
- Button-triggered manual selection (on-demand)
- One guard at a time (clear workflow)
- Status indicators (know what's ready)

OLD SYSTEM:
- OpenCV windows (doesn't work)
- Auto-prompted (blocking)
- Keyboard controls (confusing)
- Batch processing (unclear state)
- No status display (what's done?)

BOTTOM LINE:
- Click "Load Targets"
- For each "MANUAL" guard, click "Select Face"
- Draw rectangle, click "Confirm"
- Done!

================================================================================
GET HELP
================================================================================

READ: INTERACTIVE_FACE_EMBEDDING.txt (full user manual)
READ: logs/session.log (detailed debugging info)
CHECK: Code comments in Niraskhan_Done_1.py

TYPICAL SOLUTION:
1. Check logs for error message
2. Try: Click "Select Face" again
3. Try: Use different rectangle area
4. Try: Close and restart app
5. Try: Check guard profile image quality

================================================================================
Last Updated: December 15, 2025
Version: 2.1 (GUI-Based)
Status: PRODUCTION READY
================================================================================
